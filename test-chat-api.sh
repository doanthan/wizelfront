#!/bin/bash

curl -X POST http://localhost:3000/api/playwright \
  -H "Content-Type: application/json" \
  -H "Cookie: next-auth.session-token=eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..Z0GPANDh8GdVx4m0.gBEbvi3v51FjjwyWI65fQmeDR5384qAivHJ8DUocP5IoXcdCw6Y8ZDy888m-QjeixaE1cdpjNAizJw_FA30Q8w0gIRLcD04LRIQcCk010Ks0QScpNidtpH4UBWWqRWAx2ZGoj6KJrIwAVG0vSDAlIdevObVAiC4pIZNomheHHCfqxWMkisqEyEFE4_fF2FBsoDUdfGeP5D-J6AkRXuM3q7IxveNT9kFPznYBfTRm1oY5RvPI0lU5pwxub4w4eWegTvqHJZeqIlMx36lHUCW3p_NP8-0YK8KAYNxN6MsMFKdO40q6qd-hebRrQ-P3Hfzd8I3GKDMWEb02v1V-iEurpk8t9MFs3fmmO9cbWtdAD02RQPX-IRRP85u_M1JD015fWcazUd2KqmB1haJgyWOpo1XHFLatJegA16Rgj6HgoitlTblplEFpTxJLDKezbgNEHcC4eTbe3aIrTRopYSkQXG-5Ybxc_Ew0yj0AnsyiiT9vTPKBGeTVVQvJZlw9MjyPEyKFjPa8kTfHc7Pvvwcc-iXPpBqSquO5c5inaMPDUhn0AF3y-yCEOXgpcKhBH4wgMckXvlNxMJ9hpu3WLI32zo9fbJggv5WkvgmQ_-NJsK70S-OY3QJpjKt8ELTOScsoNuceQllNyeqV0-_jhhxfc75MNQ1Xv6UT9JP0rlMqqQwcqm8IDkKwNCvEk8xudyxw5kQIcOSdWptJVEIaZpoZ52z6cTbyt0FwGc1ke3yaS9PY4fd5pzuMhYMzESNEgkT--dKsxmSMYXB9KnuaSb8QvYUClLGdxml5Q8gwU1sf91Vo4KN4GI8QvVFqhx9Y1CIH3Qe16gQxnl8NwC5QE1O5WeMsGqID94QpEW5cQxenldk6r8_IZp3Fc5yzxYrm40-JX2JLt1fCO5hCm50tNKG058LuknJWzS9fVKJ66Z8u5hkI4r2V2_c276pPbzlG3wkM4KWPvJyI4YiT9tIh7wd1xSV8d6St2Y0mGZ-ehFqpSO_-Rl1VOBhvbZHehsLbofilSWv_LkiezSXfwYh_2OV7pqSI_-kqLV7fmn0ewKlmM_IHOt_0WAOHU2WQowtEFI-3gOXLlKGsZkzrmrZL-Ox2V1YnHp855ZZXyy84ySUWOGxexQU4TYfY3vZLleR4WN3n2ohu2ZkAFQNPw5IxpMYFelv4JJVnHZ8c5aREnICM3HrHEbmETbjl5heUeESHwZX5dcToBqHxLG2V1VnJW2DKXMU-ptIwI8awXJjIXKwyYF0KYxEJE-SIuTzVSBpMNRKN0YJRDqDqVuLfd0Vh3QCr9BqPBYi9cyv8EiX8S3bTTpB3kWazry_duaPBnyn2I3mnBC9WF2xhqhdu20YDc6yNXMmG7Nbw3eeENjkjc_y-GwzIs4oo_L3Jvd3NKiv1Zi1nBrhGRQvAB1yvMhtMR3pHCLxX_ZrgYtVRgoJPbMvxlImr51M5mge1bLgK8y6LGMKhzjefls_ejEewNNEP6ozHiqoNEgjaXvLku0FyCZvkvUSaBve1vcBy9Af74wPMv3tOzZ2o0t5nUj8ScjDWACyz4hdNBXLkwTYRRLU9xaUZdJSROMIL-iGntToLtRBVLL6SvXRKrwCET5a5HnHjYc0CPzF-TL_l9KoHEHLyJeYbh2-RhzWzSA2S8XcMJa1JQ88XIDE6QECMeQ3Mu2o4dGC9G2yn_uWCpL0HXdFax1Xs0yK-Me_nySmKw1zj8NuQZNm9KMBEM4uzXkqcCigok5yZD-fR12c2lw9CEbdNzAibix4-f5X5rY5kDIfgY_Jq7UIfbfhFG5vSHMZ-WdJddYnNAlKSAaR6fvvzkoyWtmEVIgIG2GvJWbwo4rqGwakfmoj4bF0HvBrOCNcShDfyIe7OEmPWyqgzmDrMcO8R6OCVzx1aI4ooqT36qVcZMmr1YmBHLMmkUpWYbbDJvCSEuP4w_SgYU_TDlsVk1mLBT3S4KPbHngxeRHkGS1NQa-E1GXPMyy8BV5KX3ZnB8VOooITvPGpvVOHZUh-01QHf_3TebpLtthOnxC9kqQSG9CdWMRPhDcoI60RhgJGZzANh2A27PaqfMlYJfhCBYJM-zfjRtYdSf_n4nVlvNBK5oC_ItRAZ-aq-klMtXT39IWul_sDxVJcJ0lHWkYXguvJbVxGPIdtin6gAephAjPU5BcfV1p6mV3L3vuGKzS7a3G5ZFiv6DnU6pZGZ2Dfh2Iaf9yaNz1Vuznw8TKMOPyQlYnT0n5pOj0P5gc3TcnVYAlAw2QBZ5BmmI42t6RJO4fQlsENEurJ2IEoij5zHRQqrcioCGY989-7fF1i4Ll8SClWyto5k0HXf4SwG1868mLLfYUt9gy6Zp4xA58OcQlYr116QSqDTItLUNjW-QeQiXivN-IGo6YTYYU6QpPfnrQxlGwIQBcbwAvMj8BAlTa-LyaKSTZ5dJnpOISXDyIwVa1CpmoQNglwGuxqDbVu1xedXr-IyjUuXzjrpx2Zd03PQ-PNidJA7WNItidD89PWT74FKGfSWFwyB4Y3KtlJTbhbVDK4wJGFUM3yACMy_Bi6CAHn8MUFbtye2xHQ0-bC-juFECGw7DQSW3hQa32weAQUQ_owz6xrO0tpF0rRE--Exr-4FBqEPFltukCXPaVu8OYTQUTgLv7cY_y5rgmemMBY2qHACgPYhU-_ZKSt8ARBigRRl-1MJtTslk8S4UzHGUD4YK6JZptPVaciqatmxVNIgw5xTz-uaANNTg9Ww59AeJcDoo4WZDgPzPFcH5t1qRcDjflVqaqEWhSd_bEyRVJZNvYs.XgCZKOpMKlioP8YTTfKkjA" \
  -d '{
    "url": "http://localhost:3000/dashboard",
    "actions": [
      {"type": "waitForSelector", "selector": "button:has(svg)", "timeout": 10000},
      {"type": "click", "selector": "button:has(svg)"},
      {"type": "waitForSelector", "selector": ".shadow-2xl", "timeout": 5000},
      {"type": "wait", "timeout": 2000}
    ]
  }' \
  -o chat-widget-dashboard.png